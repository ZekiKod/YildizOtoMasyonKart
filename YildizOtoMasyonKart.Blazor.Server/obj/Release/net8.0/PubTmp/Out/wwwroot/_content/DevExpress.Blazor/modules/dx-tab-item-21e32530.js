import{_ as e}from"./tslib.es6-d65164b3.js";import{D as t,P as r,c as s,a as i,H as a,L as n}from"./dx-html-element-pointer-events-helper-6dda355e.js";import{S as o}from"./single-slot-element-base-bbf951b4.js";import{D as d}from"./dragging-helper-81b25d77.js";import{C as l}from"./css-classes-1103f305.js";import{S as h}from"./dx-scroll-viewer-27dbfc56.js";import{T as g,a as p,D as c}from"./tabs-events-e9793aa0.js";import{n as b}from"./property-4ec0b52d.js";import{e as m}from"./custom-element-267f9a21.js";import"./dom-4684d8d6.js";import"./_commonjsHelpers-41cdd1e7.js";import"./string-2448bf95.js";import"./browser-3fc721b7.js";import"./eventhelper-8bcec49f.js";import"./constants-7c047c0d.js";import"./devices-17b9ba08.js";import"./data-qa-utils-8be7c726.js";import"./const-90026e45.js";import"./dx-ui-element-b777832b.js";import"./lit-element-base-b20b52b2.js";import"./dx-license-e00a5bc7.js";import"./lit-element-462e7ad3.js";import"./logicaltreehelper-67db40f1.js";import"./layouthelper-67dd777a.js";import"./point-e4ec110e.js";import"./dx-html-element-base-aa396eca.js";import"./scroll-viewer-css-classes-cc34804c.js";import"./custom-events-helper-e7f279d3.js";var u;let x=u=class extends o{constructor(){super(...arguments),this.boundOnDragStartHandler=this.handleDragStart.bind(this),this.boundOnDragStopHandler=this.handleDrop.bind(this),this.boundOnDragCancelHandler=this.handleDragEnd.bind(this),this.pointerEventsHelper=new t(this),this.allowReorder=!1,this.index=-1}handleDragStart(e){u.draggingHelper.start(this,e.detail.source),e.stopPropagation()}handleDragEnd(e){u.draggingHelper.stop(),e.stopPropagation()}handleDrop(e){if(u.draggingHelper.isValidTarget(this)){const e=u.draggingHelper.getDragIndex(),t=u.draggingHelper.getDropIndex();e!==t&&this.dispatchEvent(new p(e,t))}u.draggingHelper.stop(),e.stopPropagation()}isDraggableTab(){return this.allowReorder}get tabs(){return this.closest(c.Tabs)}connectedCallback(){super.connectedCallback(),this.isDraggableTab()&&this.addDragEventSubscriptions()}disconnectedCallback(){this.isDraggableTab()&&this.removeDragEventSubscriptions(),super.disconnectedCallback()}updated(e){e.has("allowReorder")&&this.onAllowTabReorderChanged(),super.updated(e)}addDragEventSubscriptions(){this.addEventListener(r.eventName,this.boundOnDragStartHandler),this.addEventListener(s.eventName,this.boundOnDragCancelHandler),this.addEventListener(i.eventName,this.boundOnDragStopHandler),this.pointerEventsHelper.initialize()}removeDragEventSubscriptions(){this.removeEventListener(r.eventName,this.boundOnDragStartHandler),this.removeEventListener(s.eventName,this.boundOnDragCancelHandler),this.removeEventListener(i.eventName,this.boundOnDragStopHandler),this.pointerEventsHelper.dispose()}onAllowTabReorderChanged(){this.isDraggableTab()?this.addDragEventSubscriptions():this.removeDragEventSubscriptions()}get handlePointerEventsMode(){return a.Dragging}get handlePointerEventsTarget(){return this}get handlePointerEventsDelay(){return n}get hoverTitleElementsSelector(){return null}get bypassNonInlineHoverTitleElementChildSelector(){return null}shouldProcessPointerEvent(e){return!e.target.closest(`.${g.CloseButton}`)}};x.draggingHelper=new class extends d{constructor(){super(...arguments),this.dragIndex=-1,this.dropIndex=-1,this.dxTabs=null,this.tabsUl=null,this.dxTabItems=null,this.dropTargetIndicator=null,this.restoreDisabled=!1,this.boundOnScroll=this.onScroll.bind(this)}start(e,t){var r;this.dxTabs=e.tabs,this.tabsUl=e.closest("ul"),this.dxTabItems=Array.from(this.tabsUl.querySelectorAll(`:scope > li > .${g.Item}`)),this.dragIndex=this.dxTabItems.indexOf(e),this.dropIndex=this.dragIndex,super.start(e,t),this.dropTargetIndicator=this.addDropTargetIndicator(),this.dxTabs.classList.add(l.Dragging),document.body.classList.add(l.GrabbingCursor),e.classList.contains(l.Disabled)||(e.classList.add(l.Disabled),this.restoreDisabled=!0);const s=this.dxTabs.scrollViewer;s&&(s.startAutoScrolling(this.dxTabs.isVertical?h.Vertical:h.Horizontal),null===(r=this.dxTabs.scrollViewerContentContainer)||void 0===r||r.addEventListener("scroll",this.boundOnScroll)),document.addEventListener("wheel",this.boundOnScroll)}stop(){var e,t;const r=this.draggableContext.srcElement;super.stop(),this.removeDropTargetIndicator(),this.dxTabs.classList.remove(l.Dragging),this.restoreDisabled&&(r.classList.remove(l.Disabled),this.restoreDisabled=!1),document.body.classList.remove(l.GrabbingCursor);this.dxTabs.scrollViewer&&(null===(e=this.dxTabs.scrollViewer)||void 0===e||e.stopAutoScrolling(),null===(t=this.dxTabs.scrollViewerContentContainer)||void 0===t||t.removeEventListener("scroll",this.boundOnScroll)),document.removeEventListener("wheel",this.boundOnScroll),this.dxTabs=null,this.tabsUl=null,this.dxTabItems=null,this.dragIndex=-1,this.dropIndex=-1}isValidTarget(e){return this.dxTabs===e.tabs}getDragIndex(){return Number(this.dxTabItems[this.dragIndex].index)}getDropIndex(){return Number(this.dxTabItems[this.dropIndex].index)}getDraggableElement(e){const t=e.getBoundingClientRect(),r=e.cloneNode(!0);return r.id="",r.style.position="fixed",r.style.top=`${t.top}px`,r.style.left=`${t.left}px`,r.classList.add(l.Dragging),e.parentElement.insertBefore(r,e),r}hideDraggableElement(){super.hideDraggableElement(),this.draggableContext.dragableElement.remove()}addDropTargetIndicator(){const e=document.createElement("div");return e.classList.add(l.DropTargetIndicator,l.Invisible),this.tabsUl.parentElement.insertBefore(e,null),e}removeDropTargetIndicator(){this.dropTargetIndicator.remove(),this.dropTargetIndicator=null}showDropTargetIndicator(){this.dropTargetIndicator.classList.remove(l.Invisible)}hideDropTargetIndicator(){this.dropIndex=this.dragIndex,this.dropTargetIndicator.classList.add(l.Invisible)}onScroll(){this.hideDropTargetIndicator()}onDocumentScroll(e){super.onDocumentScroll(e),this.onScroll()}onDocumentMouseMove(e){if(super.onDocumentMouseMove(e),e.target===this.dropTargetIndicator)return;const t=e.target.closest(`.${g.Item}`);t&&this.isValidTarget(t)?(this.updateDropIndex(e,t),this.updateDropTargetIndicatorPosition()):this.hideDropTargetIndicator()}updateDropIndex(e,t){var r;const s=this.dxTabItems.indexOf(t);let i,a;const n=t.getBoundingClientRect();(null===(r=this.dxTabs)||void 0===r?void 0:r.isVertical)?(a=n.y+n.height/2,i=e.clientY):(a=n.x+n.width/2,i=e.clientX),this.dropIndex=i>a?s+1:s,this.dragIndex<this.dropIndex&&(this.dropIndex=this.dropIndex-1)}updateDropTargetIndicatorPosition(){if(this.dragIndex===this.dropIndex)return void this.hideDropTargetIndicator();this.showDropTargetIndicator();const e=this.dxTabItems[this.dropIndex].getBoundingClientRect();let t=e.y,r=e.x;this.dragIndex<this.dropIndex&&(this.dxTabs.isVertical?t+=e.height-this.dropTargetIndicator.offsetHeight:r+=e.width-this.dropTargetIndicator.offsetWidth),this.dropTargetIndicator.style.top=`${t}px`,this.dropTargetIndicator.style.left=`${r}px`,this.dxTabs.isVertical?this.dropTargetIndicator.style.width=`${e.width}px`:this.dropTargetIndicator.style.height=`${e.height}px`}updateDraggableElementPosition(){if(super.updateDraggableElementPosition(),!this.draggableContext)return;const e=this.draggableContext;e.draggableElementPosition={x:e.draggableElementPosition.x-e.draggableElementOffset.x,y:e.draggableElementPosition.y-e.draggableElementOffset.y}}},e([b({type:Boolean,attribute:"allow-reorder"})],x.prototype,"allowReorder",void 0),e([b({type:Number,attribute:"index"})],x.prototype,"index",void 0),x=u=e([m("dxbl-tab-item")],x);export{x as DxTabItem};
