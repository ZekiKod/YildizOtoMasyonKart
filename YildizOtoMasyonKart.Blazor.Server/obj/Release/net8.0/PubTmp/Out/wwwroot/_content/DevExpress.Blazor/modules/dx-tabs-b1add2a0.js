import{_ as t}from"./tslib.es6-d65164b3.js";import{d as e}from"./dom-4684d8d6.js";import{S as i}from"./scroll-viewer-css-classes-cc34804c.js";import{T as s}from"./toolbar-css-classes-795f4ae0.js";import{u as o,R as n,d as l,f as r,h as a,j as c,k as h,c as d,s as u,l as m}from"./dom-utils-bf33c859.js";import{U as b}from"./ribbon-utils-8b4ac48a.js";import{a as p,R as f}from"./layouthelper-67dd777a.js";import{attachEventsForFocusHiding as v}from"./focus-utils-1fc0087c.js";import{S}from"./single-slot-element-base-bbf951b4.js";import{T as g,A as C,D as T}from"./tabs-events-e9793aa0.js";import{C as E}from"./css-classes-1103f305.js";import{n as w}from"./property-4ec0b52d.js";import{e as k}from"./custom-element-267f9a21.js";import"./_commonjsHelpers-41cdd1e7.js";import"./string-2448bf95.js";import"./browser-3fc721b7.js";import"./point-e4ec110e.js";import"./constants-7c047c0d.js";import"./key-a66127fc.js";import"./disposable-d2c2d283.js";import"./logicaltreehelper-67db40f1.js";import"./data-qa-utils-8be7c726.js";import"./const-90026e45.js";import"./dx-ui-element-b777832b.js";import"./lit-element-base-b20b52b2.js";import"./dx-license-e00a5bc7.js";import"./lit-element-462e7ad3.js";import"./custom-events-helper-e7f279d3.js";var x,B,L,y,M,N;!function(t){t.Default="Default",t.AllTabs="AllTabs",t.OnDemand="OnDemand"}(x||(x={})),function(t){t.Auto="Auto",t.NavButtons="NavButtons",t.Swipe="Swipe",t.NoScroll="NoScroll"}(B||(B={})),function(t){t.Small="Small",t.Medium="Medium",t.Large="Large"}(L||(L={})),function(t){t.Top="Top",t.Bottom="Bottom",t.Left="Left",t.Right="Right"}(y||(y={})),function(t){t[t.None=0]="None",t[t.Back=1]="Back",t[t.Forward=2]="Forward"}(M||(M={}));class j{static calculate(t,e,i,s,o,n){const l=e?i.height:i.width,r=e?s.bottom:s.right,a=e?s.top:s.left,c=e?i.bottom:i.right,h=e?i.top:i.left,d=n?e?n.bottom:n.right:0,u=o?e?o.top:o.left:0;let m=a-h;switch(t){case M.Forward:m=Math.round(r-c),0===Math.round(m)&&n&&(m=Math.round(d-c)),m=Math.min(Math.max(0,m),l),0===m&&(m=l);break;case M.Back:m=Math.round(a)-Math.round(h),0===Math.round(m)&&o&&(m=Math.round(u-h)),m=-Math.min(Math.max(0,Math.abs(m)),l),0===m&&(m=-l);break;default:{const t=a<h,e=r>c;if(!t&&!e)return 0;if(e){const t=n?d-c:0;m=n&&a-t>=h?m=t:r-c}else if(t){const t=-a+h,e=o?-u+h:0;m=o&&r+e<=c?-e:r+t<=c?-t:0}break}}return Math.ceil(m)}}const R="data-dxtabs-tab-id",D="data-dxtabs-content-id",I="tab-count",z="scroll-mode",O="render-mode",A="active-tab",U="size-mode",F="tabs-position";let H=N=class extends S{constructor(){super(...arguments),this.mainElementContentWidthSubscription=null,this.contentPanelWidthSubscription=null,this.currentSize={width:null,height:null},this.contentSize={width:null,height:null},this.scrollContainerElement=null,this.canTrackScroll=!1,this.tabListElement=null,this.updateOverflowStateTimeout=0,this.isReady=!1,this.neededCheckSize=!1,this.unsubscribeFocusUtils=null,this.unsubscribe=null,this.onScrollHandler=this.onScroll.bind(this),this.onNextButtonClickHandler=this.onScrollToNext.bind(this),this.onPrevButtonClickHandler=this.onScrollToPrev.bind(this),this.onClickHandler=this.onClick.bind(this),this.tabCount=0,this.scrollMode=B.Auto,this.renderMode=x.Default,this.activeTab="",this.sizeMode=L.Medium,this.tabsPosition=y.Top}get isVertical(){return this.tabsPosition===y.Left||this.tabsPosition===y.Right}get listElement(){return this.tabListElement.getElementsByTagName("ul")[0]}getActiveTab(){return this.querySelector(N.getSelector(R,this.activeTab))}get activeTabIndex(){return Array.from(this.querySelectorAll(`.${g.Item}`)).findIndex((t=>t.classList.contains(E.Active)))}get scrollViewer(){return this.querySelector(`.${i.ClassName}`)}get scrollViewerContentContainer(){return this.tabListElement?e.DomUtils.getNodesByClassName(this.tabListElement,i.ContentContainerClassName)[0]:null}get prevButton(){var t;return null===(t=this.findScrollContainer())||void 0===t?void 0:t.querySelector(`:scope > .${g.ButtonScrollPrev}`)}get nextButton(){var t;return null===(t=this.findScrollContainer())||void 0===t?void 0:t.querySelector(`:scope > .${g.ButtonScrollNext}`)}get tabsContentElement(){return this.querySelector(`:scope > .${g.ContentPanel}`)}connectedOrContentChanged(){const t=this.querySelector(`:scope > .${g.TabList}`);t&&t!==this.tabListElement&&(this.tabListElement=t,this.dispose(),this.subscribeToEvents(),this.initialize(),this.isReady=!0)}disconnectedCallback(){super.disconnectedCallback(),this.disposeEvents(),this.dispose()}disposeEvents(){var t,e;null===(t=this.unsubscribe)||void 0===t||t.call(this),this.unsubscribe=null,null===(e=this.unsubscribeFocusUtils)||void 0===e||e.call(this),this.unsubscribeFocusUtils=null}subscribeToEvents(){if(!this.tabListElement)return;if(this.disposeEvents(),this.scrollMode!==B.NavButtons&&this.scrollMode!==B.Swipe)return;const t=this.scrollViewerContentContainer;null==t||t.addEventListener("scroll",this.onScrollHandler),null==t||t.addEventListener("click",this.onClickHandler);const e=this.prevButton;null==e||e.addEventListener("click",this.onPrevButtonClickHandler);const i=this.nextButton;null==i||i.addEventListener("click",this.onNextButtonClickHandler),this.unsubscribe=()=>{null==t||t.removeEventListener("scroll",this.onScrollHandler),null==t||t.removeEventListener("click",this.onClickHandler),null==e||e.removeEventListener("click",this.onPrevButtonClickHandler),null==i||i.removeEventListener("click",this.onNextButtonClickHandler)},this.unsubscribeFocusUtils=v(this.tabListElement)}dispose(){this.isReady=!1,this.updateOverflowStateTimeout&&(clearTimeout(this.updateOverflowStateTimeout),this.updateOverflowStateTimeout=0),this.mainElementContentWidthSubscription&&o(this.mainElementContentWidthSubscription),this.contentPanelWidthSubscription&&o(this.contentPanelWidthSubscription),this.neededCheckSize=!1}activate(t){if(!t)return;const e=document.querySelector(N.getSelector(R,t));if(null!=(null==e?void 0:e.parentNode)){const t=this.listElement;for(let i=0;i<this.tabCount;i++)if(b.getChildByClassName(t.children[i],g.Item)===e){this.scrollToIndex(i);break}}}onScroll(t){this.updateOverflowState()}initialize(){n((()=>{this.prepareScrollMode(),e.DomUtils.addClassName(this.tabListElement,s.Loaded),this.checkForOverflow()})),this.mainElementContentWidthSubscription=l(this.tabListElement,(t=>{this.currentSize.width===t.width&&this.currentSize.height===t.height||(this.currentSize={width:t.width,height:t.height},this.checkForOverflow())}));const t=this.tabsContentElement;t&&(this.contentPanelWidthSubscription=l(t,(t=>{this.contentSize.width===t.width&&this.contentSize.height===t.height||(this.contentSize={width:t.width,height:t.height},this.onContentElementResize())})))}onContentElementResize(){this.updateSelectedContent()}updated(t){this.isReady&&((t.has("scrollMode")||t.has("tabCount")||t.has("sizeMode")||t.has("tabsPosition"))&&(n((()=>{this.prepareScrollMode(),this.checkForOverflow()})),this.subscribeToEvents()),t.has("activeTab")&&this.activate(this.activeTab),(t.has("renderMode")||t.has("activeTab"))&&this.updateSelectedContent(this.dispatchActiveTabChangedEvent.bind(this)),super.updated(t))}dispatchActiveTabChangedEvent(){this.dispatchEvent(new C)}queryUpdateOverflowState(t){this.updateOverflowStateTimeout&&clearTimeout(this.updateOverflowStateTimeout),this.updateOverflowStateTimeout=setTimeout((()=>{this.updateOverflowStateTimeout=0,this.updateOverflowState()}),t)}prepareScrollMode(){this.neededCheckSize=!!this.tabListElement&&this.scrollMode===B.NavButtons}checkForOverflow(){if(!this.neededCheckSize||!this.tabListElement)return;const t=this.isVertical?this.tabListElement.getBoundingClientRect().height-r(this.tabListElement):this.tabListElement.getBoundingClientRect().width-a(this.tabListElement);this.togleScrollState(t-this.calcNeededSize()<=-1)}togleScrollState(t){n((()=>{e.DomUtils.toggleClassName(this.tabListElement,g.HasOverflow,t),this.canTrackScroll=t,t&&this.queryUpdateOverflowState()}))}calcNeededSize(){var t;const e=null===(t=this.tabListElement)||void 0===t?void 0:t.getElementsByTagName("ul")[0];if(!e)return 0;let i=this.isVertical?r(e):a(e);const s=e.getElementsByTagName("li");for(const t of s)i+=this.isVertical?t.getBoundingClientRect().height+c(t):t.getBoundingClientRect().width+h(t);return i}updateOverflowState(){if(!this.canTrackScroll||this.scrollMode!==B.NavButtons)return;if(!this.findScrollContainer())return;const t=this.scrollViewerContentContainer;if(!t)return;const[e,i]=this.getScrollAccess(t),s=this.nextButton,o=this.prevButton;d((()=>{s&&u(s,"disabled",!i),o&&u(o,"disabled",!e)}))}getScrollAccess(t){if(this.isVertical){const e=Math.ceil(t.scrollTop);return[e>0,Math.round(t.scrollHeight-e)-Math.round(t.clientHeight)>N.minScrollStep]}{const e=Math.ceil(t.scrollLeft);return[e>0,Math.round(t.scrollWidth-e)-Math.round(t.clientWidth)>N.minScrollStep]}}findScrollContainer(){if(!this.scrollContainerElement){if(!this.tabListElement)return null;this.scrollContainerElement=b.elementMatchesSelector(this.tabListElement,`.${g.Scrollable}`)?this.tabListElement:this.tabListElement.querySelector(`.${g.Scrollable}`)}return this.scrollContainerElement}onScrollToPrev(t){t.preventDefault();const e=this.findExtremeTabItemIndex(M.Back);this.scrollToIndex(e,M.Back)}onScrollToNext(t){t.preventDefault();const e=this.findExtremeTabItemIndex(M.Forward);this.scrollToIndex(e,M.Forward)}onClick(t){let e=t.target;for(;e;){if(m(e,g.Item)){const t=e.getAttribute(R);t&&this.activate(t);break}e=e.parentElement}}getTabElement(t){return this.listElement.querySelectorAll(":scope > li > ."+g.Item)[t]}scrollToIndex(t,e=M.None){var i,s;if(t>-1&&this.scrollViewerContentContainer){const o=t=>t.closest("li"),n=this.getTabElement(t),l=null===(i=o(n))||void 0===i?void 0:i.nextElementSibling,r=null===(s=o(n))||void 0===s?void 0:s.previousElementSibling;this.scrollToTab(n,r,l,e)}}findExtremeTabItemIndex(t){if(t===M.None)return-1;const e=this.scrollViewerContentContainer;if(!e)return-1;const i=this.listElement.querySelectorAll(":scope > li > ."+g.Item),s=this.getContentFrameRect(e),[o,n,l]=t===M.Forward?[0,this.tabCount,1]:[this.tabCount-1,-1,-1];for(let e=o;e!==n;e+=l){const o=i[e].getBoundingClientRect();if(this.isVertical){if(t===M.Back&&o.top<s.top||t===M.Forward&&o.bottom>s.bottom)return e}else if(t===M.Back&&o.left<s.left||t===M.Forward&&o.right>s.right)return e}return-1}getContentFrameRect(t){const i=e.DomUtils.getCurrentStyle(t),s=t.getBoundingClientRect();return new p(s.left+e.DomUtils.pxToInt(i.paddingLeft)+e.DomUtils.pxToInt(i.borderLeftWidth),s.top+e.DomUtils.pxToInt(i.paddingTop)+e.DomUtils.pxToInt(i.borderTopWidth),s.width-e.DomUtils.pxToInt(i.paddingRight)-e.DomUtils.pxToInt(i.borderRightWidth),s.height-e.DomUtils.pxToInt(i.paddingBottom)-e.DomUtils.pxToInt(i.borderBottomWidth))}scrollToTab(t,e,i,s){const o=this.scrollViewerContentContainer;if(!o)return;const n=j.calculate(s,this.isVertical,this.getContentFrameRect(o),f.fromDomRect(t.getBoundingClientRect()),e?f.fromDomRect(e.getBoundingClientRect()):void 0,i?f.fromDomRect(i.getBoundingClientRect()):void 0);0!==n?this.isVertical?o.scrollTop+=n:o.scrollLeft+=n:o.scrollLeft>0&&s===M.Back&&(this.isVertical?o.scrollTop=0:o.scrollLeft=0)}updateSelectedContent(t=null){const i=this.tabsContentElement;if(i){const o=this.activeTab?i.querySelector(N.getSelector(D,this.activeTab)):null,l=Array.from(i.querySelectorAll(`:scope > .${g.Content}${this.activeTab?`:not(${N.getSelector(D,this.activeTab)})`:""}`));n((()=>{if(o&&(o.style.cssText="",o.setAttribute("data-dx-tab-loaded","")),this.renderMode!==x.Default){const t=`position:absolute;visibility:hidden;left:-10000px;top:-10000px;width:${i.clientWidth}px;height:${i.clientHeight}px`;l.forEach((e=>{e.style.cssText=t}))}i&&e.DomUtils.addClassName(i,s.Loaded),t&&setTimeout((()=>t()),0)}))}}static getSelector(t,e){return`[${t}=${e}]`}};H.minScrollStep=1,t([w({type:Number,attribute:I})],H.prototype,"tabCount",void 0),t([w({type:B,attribute:z})],H.prototype,"scrollMode",void 0),t([w({type:x,attribute:O})],H.prototype,"renderMode",void 0),t([w({attribute:A})],H.prototype,"activeTab",void 0),t([w({attribute:U})],H.prototype,"sizeMode",void 0),t([w({attribute:F})],H.prototype,"tabsPosition",void 0),H=N=t([k(T.Tabs)],H);const q={loadModule:function(){}};export{H as DxTabs,q as default,R as tabIdSelector};
